# VISION TEST í…œí”Œë¦¿ ê°œë°œ PRD
## Product Requirements Document

**ë²„ì „**: 1.0
**ìµœì¢… ìˆ˜ì •ì¼**: 2025-01-14
**ëŒ€ìƒ í•™ë…„**: ì´ˆë“±í•™êµ 2í•™ë…„ (í–¥í›„ í™•ì¥ ê°€ëŠ¥)
**í”„ë¡œì íŠ¸ëª…**: ì‹œì„  ì¶”ì  ê¸°ë°˜ ë¬¸í•´ë ¥ ì§„ë‹¨ ì‹œìŠ¤í…œ

---

## ëª©ì°¨

1. [ê°œìš”](#1-ê°œìš”)
2. [ê¸°ìˆ  ìŠ¤íƒ](#2-ê¸°ìˆ -ìŠ¤íƒ)
3. [ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜](#3-ì‹œìŠ¤í…œ-ì•„í‚¤í…ì²˜)
4. [ë°ì´í„°ë² ì´ìŠ¤ ì„¤ê³„](#4-ë°ì´í„°ë² ì´ìŠ¤-ì„¤ê³„)
5. [ë°±ì—”ë“œ API ì„¤ê³„](#5-ë°±ì—”ë“œ-api-ì„¤ê³„)
6. [í”„ë¡ íŠ¸ì—”ë“œ êµ¬ì¡°](#6-í”„ë¡ íŠ¸ì—”ë“œ-êµ¬ì¡°)
7. [í•µì‹¬ ê¸°ëŠ¥ ëª…ì„¸](#7-í•µì‹¬-ê¸°ëŠ¥-ëª…ì„¸)
8. [ì‚¬ìš©ì í”Œë¡œìš°](#8-ì‚¬ìš©ì-í”Œë¡œìš°)
9. [ê´€ë¦¬ì ê¸°ëŠ¥](#9-ê´€ë¦¬ì-ê¸°ëŠ¥)
10. [ì„±ëŠ¥ ìš”êµ¬ì‚¬í•­](#10-ì„±ëŠ¥-ìš”êµ¬ì‚¬í•­)
11. [ë³´ì•ˆ ë° ê°œì¸ì •ë³´](#11-ë³´ì•ˆ-ë°-ê°œì¸ì •ë³´)
12. [ê°œë°œ ë¡œë“œë§µ](#12-ê°œë°œ-ë¡œë“œë§µ)

---

## 1. ê°œìš”

### 1.1 ëª©ì 
ê¸°ì¡´ ë¬¸í•´ë ¥ í…ŒìŠ¤íŠ¸ì— ì‹œì„  ì¶”ì (Eye-Tracking) ê¸°ìˆ ì„ í†µí•©í•˜ì—¬ í•™ìƒë“¤ì˜ ì½ê¸° ê³¼ì •ì„ ì‹¤ì‹œê°„ìœ¼ë¡œ ë¶„ì„í•˜ê³ , ì½ê¸° ëŠ¥ë ¥ì— ëŒ€í•œ ì‹¬ì¸µì ì¸ ì§„ë‹¨ì„ ì œê³µí•œë‹¤.

### 1.2 í•µì‹¬ ê°€ì¹˜
- **ì •ëŸ‰ì  ì½ê¸° ë¶„ì„**: ì‹œì„  ë„ì•½í­, ì‘ì‹œ ì‹œê°„, ì—­í–‰ ë¹„ìœ¨ ë“± 15ê°œ ë©”íŠ¸ë¦­ ì¸¡ì •
- **ì‹œê°í™”**: ì‹œì„  ê²½ë¡œ ì¬ìƒ, íˆíŠ¸ë§µ, 3D ì‹œì„  íë¦„
- **AI ë¶„ì„**: ì½ê¸° ì „ëµ ë¶„ì„, ê°œì¸ ë§ì¶¤ ì§„ë‹¨ ë° í•™ìŠµ ì²˜ë°©
- **ë¹„êµ ë¶„ì„**: ì‹œê³„ì—´ ë¹„êµ, í•™ìƒ ê°„ ë¹„êµ

### 1.3 ë²”ìœ„
- **Phase 1**: ì´ˆë“± 2í•™ë…„ìš© VISION TEST í…œí”Œë¦¿ êµ¬í˜„
- **Phase 2**: ë‹¤ë¥¸ í•™ë…„ í™•ì¥ ë° ê³ ê¸‰ ê¸°ëŠ¥ ì¶”ê°€
- **Phase 3**: ì‹¤ì‹œê°„ í•™ìŠµ ê°œì… ë° AI ê³ ë„í™”

### 1.4 ì œì™¸ ì‚¬í•­
- ì „ìš© í•˜ë“œì›¨ì–´ëŠ” ì‚¬ìš©í•˜ì§€ ì•ŠìŒ (ì›¹ìº /íƒœë¸”ë¦¿ ì¹´ë©”ë¼ë§Œ ì‚¬ìš©)
- ë³„ë„ ì•± ê°œë°œí•˜ì§€ ì•ŠìŒ (ê¸°ì¡´ ì›¹ì— í†µí•©)

---

## 2. ê¸°ìˆ  ìŠ¤íƒ

### 2.1 í”„ë¡ íŠ¸ì—”ë“œ
```typescript
{
  "framework": "React 18 + TypeScript",
  "styling": "Tailwind CSS (ë””ìì¸ ì‹œìŠ¤í…œ ì ìš©)",
  "eyeTracking": "TensorFlow.js + MediaPipe Face Mesh",
  "visualization": {
    "2D": "HTML5 Canvas API",
    "charts": "Chart.js",
    "3D": "Three.js (React Three Fiber)"
  },
  "state": "React Context API + useState/useReducer",
  "routing": "React Router v6"
}
```

### 2.2 ë°±ì—”ë“œ
```typescript
{
  "runtime": "Node.js 20 + Express",
  "language": "TypeScript",
  "database": "PostgreSQL (Prisma ORM)",
  "fileStorage": "Local filesystem (í–¥í›„ S3 í™•ì¥ ê°€ëŠ¥)",
  "auth": "JWT + bcrypt"
}
```

### 2.3 ì¸í”„ë¼
```yaml
hosting: "Render (ê¸°ì¡´ í™˜ê²½ ìœ ì§€)"
database: "Supabase PostgreSQL"
cdn: "Render CDN"
monitoring: "Render ê¸°ë³¸ ëª¨ë‹ˆí„°ë§"
```

---

## 3. ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜

### 3.1 ì „ì²´ êµ¬ì¡°ë„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      í´ë¼ì´ì–¸íŠ¸ (ë¸Œë¼ìš°ì €)                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚ React UI      â”‚  â”‚ TensorFlow.jsâ”‚  â”‚ MediaPipe    â”‚     â”‚
â”‚  â”‚ Components    â”‚  â”‚ + Face Mesh  â”‚  â”‚ (ì‹œì„  ì¶”ì )   â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚         â”‚                   â”‚                  â”‚             â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â”‚                             â”‚                                â”‚
â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚
â”‚                    â”‚  Gaze Processor â”‚                       â”‚
â”‚                    â”‚  (ì‹œì„  ë°ì´í„°    â”‚                       â”‚
â”‚                    â”‚   ì‹¤ì‹œê°„ ì²˜ë¦¬)   â”‚                       â”‚
â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚
â”‚                             â”‚                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚ HTTPS
                              â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      ë°±ì—”ë“œ ì„œë²„ (Node.js)                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚              REST API Endpoints                      â”‚    â”‚
â”‚  â”‚  /api/v1/vision/...                                 â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚         â”‚                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚           ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ë ˆì´ì–´                         â”‚    â”‚
â”‚  â”‚  - Calibration Manager                              â”‚    â”‚
â”‚  â”‚  - Gaze Data Analyzer                               â”‚    â”‚
â”‚  â”‚  - Metrics Calculator (15ê°œ ë©”íŠ¸ë¦­)                  â”‚    â”‚
â”‚  â”‚  - AI Analysis Engine                               â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚         â”‚                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚           ë°ì´í„° ì ‘ê·¼ ë ˆì´ì–´ (Prisma)                 â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚         â”‚                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   PostgreSQL Database                          â”‚
â”‚  - TestTemplate (vision íƒ€ì… ì¶”ê°€)                             â”‚
â”‚  - VisionTestSession (ì‹œì„  ì¶”ì  ì„¸ì…˜)                          â”‚
â”‚  - VisionGazeData (ì›ë³¸ ì‹œì„  ë°ì´í„°)                           â”‚
â”‚  - VisionMetrics (ê³„ì‚°ëœ 15ê°œ ë©”íŠ¸ë¦­)                          â”‚
â”‚  - VisionCalibration (ìº˜ë¦¬ë¸Œë ˆì´ì…˜ ë°ì´í„°)                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.2 ë°ì´í„° íë¦„

#### í…ŒìŠ¤íŠ¸ ì§„í–‰ ì‹œ
```
1. í•™ìƒ ë¡œê·¸ì¸ â†’ 2. Vision í…œí”Œë¦¿ ì„ íƒ
       â†“
3. í™˜ê²½ ì²´í¬ (ì¹´ë©”ë¼, ì¡°ëª…, ê±°ë¦¬)
       â†“
4. ìº˜ë¦¬ë¸Œë ˆì´ì…˜ (9í¬ì¸íŠ¸, ì •í™•ë„ >70%)
       â†“
5. ì½ê¸° ì§€ë¬¸ ì œì‹œ + ì‹¤ì‹œê°„ ì‹œì„  ì¶”ì 
       â†“
6. ë¬¸ì œ í’€ì´ (ì§€ë¬¸ í† ê¸€ ì˜µì…˜)
       â†“
7. ì‹œì„  ë°ì´í„° + ë‹µì•ˆ ì œì¶œ
       â†“
8. ë°±ì—”ë“œ: ë©”íŠ¸ë¦­ ê³„ì‚° + AI ë¶„ì„
       â†“
9. ê²°ê³¼ ë¦¬í¬íŠ¸ ìƒì„± (ì‹œê°í™” í¬í•¨)
```

#### ê´€ë¦¬ì ë¦¬í¬íŠ¸ ì¡°íšŒ ì‹œ
```
1. ê´€ë¦¬ì ë¡œê·¸ì¸ â†’ 2. Vision Analytics ì„ íƒ
       â†“
3. í•™ìƒ/ì„¸ì…˜ ì„ íƒ
       â†“
4. ë°±ì—”ë“œ: ì €ì¥ëœ ì‹œì„  ë°ì´í„° + ë©”íŠ¸ë¦­ ì¡°íšŒ
       â†“
5. ì‹œì„  ê²½ë¡œ ì¬ìƒ + ì‹œê°í™” ë Œë”ë§
       â†“
6. ìˆ˜ë™ ë³´ì • (í•„ìš”ì‹œ)
       â†“
7. ë³´ì •ëœ ë°ì´í„° ì¬ê³„ì‚° ë° ì €ì¥
```

---

## 4. ë°ì´í„°ë² ì´ìŠ¤ ì„¤ê³„

### 4.1 ìŠ¤í‚¤ë§ˆ í™•ì¥

```prisma
// ===================================
// ê¸°ì¡´ ëª¨ë¸ í™•ì¥
// ===================================

model TestTemplate {
  id                String   @id @default(cuid())
  code              String   @unique        // ì˜ˆ: "VISION_G2_001"
  title             String
  grade             Int
  category          String
  description       String?

  // Vision í…œí”Œë¦¿ ì—¬ë¶€
  templateType      String   @default("standard")  // "standard" | "vision"
  visionConfig      Json?    // Vision ì „ìš© ì„¤ì •

  questions         Question[]
  testSessions      TestSession[]

  createdAt         DateTime @default(now())
  updatedAt         DateTime @updatedAt

  @@index([templateType])
}

// VisionConfig êµ¬ì¡° (JSON)
interface VisionConfig {
  enableEyeTracking: boolean;
  targetGrade: number;
  calibrationPoints: number;           // ê¸°ë³¸ 9ê°œ
  passages: Array<{
    id: string;
    text: string;
    fontSize: number;                  // í•™ë…„ë³„ ì¡°ì •
    lineHeight: number;
    difficulty: number;
    expectedWPM: number;
    showPassageWithQuestions: boolean; // ì§€ë¬¸-ë¬¸ì œ í† ê¸€
  }>;
  expectedMetrics: {
    saccade: [number, number];
    fixation: [number, number];
    regression: number;
    wpm: [number, number];
  };
}

// ===================================
// ìƒˆë¡œìš´ Vision ì „ìš© ëª¨ë¸
// ===================================

// 1. Vision í…ŒìŠ¤íŠ¸ ì„¸ì…˜
model VisionTestSession {
  id                String   @id @default(cuid())
  sessionId         String   @unique       // TestSessionê³¼ 1:1 ì—°ê²°
  session           TestSession @relation(fields: [sessionId], references: [id], onDelete: Cascade)

  // í™˜ê²½ ì²´í¬ ë°ì´í„°
  environmentCheck  Json     // { cameraOk, lightingOk, distanceOk, faceDetected }

  // ìº˜ë¦¬ë¸Œë ˆì´ì…˜ ë°ì´í„°
  calibrationId     String?
  calibration       VisionCalibration? @relation(fields: [calibrationId], references: [id])
  calibrationScore  Float?   // ìº˜ë¦¬ë¸Œë ˆì´ì…˜ ì •í™•ë„ (0-100)

  // ì‹œì„  ì¶”ì  ì›ë³¸ ë°ì´í„° (ë³„ë„ í…Œì´ë¸” ì°¸ì¡°)
  gazeData          VisionGazeData[]

  // ê³„ì‚°ëœ ë©”íŠ¸ë¦­ (ë³„ë„ í…Œì´ë¸” ì°¸ì¡°)
  metrics           VisionMetrics?

  // ë¶„ì„ ê²°ê³¼
  aiAnalysis        Json?    // AI ë¶„ì„ ê²°ê³¼
  readingStrategy   String?  // "detailed" | "scanning" | "skimming" | "mixed"

  // ì‹œê°í™” ë°ì´í„°
  heatmapData       Json?    // íˆíŠ¸ë§µ ìƒì„±ìš© ë°ì´í„°
  attentionZones    Json?    // ì£¼ì˜ë ¥ ì˜ì—­ ë¶„ì„

  createdAt         DateTime @default(now())
  updatedAt         DateTime @updatedAt

  @@index([sessionId])
}

// 2. ì‹œì„  ë°ì´í„° (ëŒ€ìš©ëŸ‰)
model VisionGazeData {
  id                String   @id @default(cuid())
  visionSessionId   String
  visionSession     VisionTestSession @relation(fields: [visionSessionId], references: [id], onDelete: Cascade)

  // ì‹œì„  ì¢Œí‘œ (ë°°ì—´ë¡œ ì €ì¥)
  gazePoints        Json     // [{ timestamp, x, y, confidence, type }, ...]

  // ë©”íƒ€ ì •ë³´
  passageId         String   // ì–´ëŠ ì§€ë¬¸ì˜ ì‹œì„  ë°ì´í„°ì¸ì§€
  startTime         DateTime
  endTime           DateTime
  totalPoints       Int      // ë°ì´í„° í¬ì¸íŠ¸ ê°œìˆ˜

  createdAt         DateTime @default(now())

  @@index([visionSessionId])
  @@index([passageId])
}

// GazePoint êµ¬ì¡° (JSON ë°°ì—´ ë‚´ë¶€)
interface GazePoint {
  timestamp: number;          // ë°€ë¦¬ì´ˆ
  x: number;                  // í”½ì…€ ì¢Œí‘œ
  y: number;                  // í”½ì…€ ì¢Œí‘œ
  confidence: number;         // 0-1
  type: 'fixation' | 'saccade' | 'blink';
  duration?: number;          // ì‘ì‹œ ì‹œê°„ (fixationì¸ ê²½ìš°)
}

// 3. ê³„ì‚°ëœ ë©”íŠ¸ë¦­ (15ê°œ)
model VisionMetrics {
  id                String   @id @default(cuid())
  visionSessionId   String   @unique
  visionSession     VisionTestSession @relation(fields: [visionSessionId], references: [id], onDelete: Cascade)

  // A. ì‹œì„  ì´ë™ íŒ¨í„´ (6ê°œ)
  // A1. ì‹œì„  ë„ì•½í­
  averageSaccade    Float
  saccadeVariability Float
  forwardSaccadeLength Float
  regressionSaccadeLength Float
  optimalSaccadeRate Float

  // A2. ì‹œì„  ë„ì•½ ì†ë„
  averageVelocity   Float
  peakVelocity      Float

  // A3. ì‹œì„  ì •ì°©ë¥ 
  optimalLandingRate Float
  refixationRate    Float

  // A4. ì¤„ ì¶”ì  ì •í™•ë„
  returnSweepAccuracy Float
  lineSkipRate      Float

  // A5. ì‹œì„  ì•ˆì •ì„±
  blinkRate         Float
  attentionScore    Float
  fatigueIndicator  Float

  // A6. ì‹œì„  ê²½ë¡œ íš¨ìœ¨ì„±
  scanPathEfficiency Float
  sequentialReadingRate Float

  // B. ì‘ì‹œ í–‰ë™ (4ê°œ)
  // B1. ì‘ì‹œ ì‹œê°„ ë¶„í¬
  averageFixation   Float
  fixationsPerWord  Float

  // B2. ì‘ì‹œ ë°€ë„
  fixationsPerLine  Float
  readingCoverageScore Float

  // B3. ì‘ì‹œ ìˆœì„œ íŒ¨í„´
  regressionRate    Float
  regressionQualityScore Float

  // B4. ì‘ì‹œ í´ëŸ¬ìŠ¤í„°ë§
  vocabularyGapScore Float

  // C. ì½ê¸° ì†ë„ ë° ë¦¬ë“¬ (3ê°œ)
  // C1. ì½ê¸° ì†ë„
  wordsPerMinute    Float
  comprehensionAdjustedWPM Float
  speedConsistencyScore Float

  // C2. ì½ê¸° ë¦¬ë“¬
  rhythmRegularity  Float
  fluencyScore      Float

  // C3. ì½ê¸° ì§€êµ¬ë ¥
  speedDecayRate    Float
  staminaScore      Float

  // D. ì´í•´ ë° ì¸ì§€ ì²˜ë¦¬ (2ê°œ)
  // D1. ì´í•´ë„ ì—°ê³„
  gazeComprehensionCorrelation Float
  readingEfficiencyScore Float

  // D2. ì¸ì§€ ë¶€í•˜
  cognitiveLoadIndex Float
  mentalFatigueScore Float

  // ì¢…í•© ì ìˆ˜
  overallEyeTrackingScore Float  // 0-100

  // ì§„ë‹¨ í”Œë˜ê·¸
  diagnosisFlags    Json     // { slowReader, poorComprehension, attention, ... }

  createdAt         DateTime @default(now())
  updatedAt         DateTime @updatedAt
}

// 4. ìº˜ë¦¬ë¸Œë ˆì´ì…˜ ë°ì´í„°
model VisionCalibration {
  id                String   @id @default(cuid())
  userId            String
  user              User     @relation(fields: [userId], references: [id])

  // ìº˜ë¦¬ë¸Œë ˆì´ì…˜ í¬ì¸íŠ¸ (9ê°œ)
  calibrationPoints Json     // [{ id, x, y, gazeX, gazeY, error }, ...]

  // ì •í™•ë„
  overallAccuracy   Float    // 0-100
  averageError      Float    // í”½ì…€ ë‹¨ìœ„

  // ë³´ì • íŒŒë¼ë¯¸í„°
  transformMatrix   Json     // ì¢Œí‘œ ë³€í™˜ í–‰ë ¬

  // í™˜ê²½ ì •ë³´
  deviceInfo        Json     // { browser, screen, camera }

  // ìœ íš¨ì„±
  isValid           Boolean  @default(true)
  expiresAt         DateTime // 7ì¼ í›„ ë§Œë£Œ

  // ê´€ê³„
  visionSessions    VisionTestSession[]

  createdAt         DateTime @default(now())

  @@index([userId])
  @@index([isValid, expiresAt])
}

// CalibrationPoint êµ¬ì¡° (JSON ë°°ì—´ ë‚´ë¶€)
interface CalibrationPoint {
  id: number;                 // 1-9
  x: number;                  // í™”ë©´ ì¢Œí‘œ (ëª©í‘œ)
  y: number;
  gazeX: number;              // ì‹¤ì œ ì‹œì„  ì¢Œí‘œ
  gazeY: number;
  error: number;              // í”½ì…€ ë‹¨ìœ„ ì˜¤ì°¨
  attempts: number;           // ì¬ì‹œë„ íšŸìˆ˜
}

// 5. ìˆ˜ë™ ë³´ì • ê¸°ë¡
model VisionCalibrationAdjustment {
  id                String   @id @default(cuid())
  visionSessionId   String
  adminId           String
  admin             User     @relation(fields: [adminId], references: [id])

  // ë³´ì • ì „ ë°ì´í„°
  originalMetrics   Json

  // ë³´ì • íŒŒë¼ë¯¸í„°
  adjustments       Json     // { horizontalOffset, verticalOffset, scale, rotation }

  // ë³´ì • í›„ ë°ì´í„°
  adjustedMetrics   Json

  // ê°œì„ ë„
  improvementScore  Float    // ë³´ì •ìœ¼ë¡œ ì¸í•œ ê°œì„  ì •ë„

  createdAt         DateTime @default(now())

  @@index([visionSessionId])
  @@index([adminId])
}
```

### 4.2 ë°ì´í„° ê´€ê³„ë„

```
User
 â”‚
 â”œâ”€â”€ TestSession
 â”‚    â”‚
 â”‚    â””â”€â”€ VisionTestSession (1:1)
 â”‚         â”‚
 â”‚         â”œâ”€â”€ VisionCalibration (N:1)
 â”‚         â”œâ”€â”€ VisionGazeData (1:N)
 â”‚         â””â”€â”€ VisionMetrics (1:1)
 â”‚
 â””â”€â”€ VisionCalibration (1:N)

TestTemplate
 â”‚
 â””â”€â”€ TestSession
      â”‚
      â””â”€â”€ VisionTestSession
```

---

## 5. ë°±ì—”ë“œ API ì„¤ê³„

### 5.1 API ì—”ë“œí¬ì¸íŠ¸ êµ¬ì¡°

```
/api/v1/vision/
â”œâ”€â”€ calibration/
â”‚   â”œâ”€â”€ POST   /check-environment
â”‚   â”œâ”€â”€ POST   /start
â”‚   â”œâ”€â”€ POST   /record-point
â”‚   â”œâ”€â”€ POST   /validate
â”‚   â””â”€â”€ GET    /history/:userId
â”œâ”€â”€ session/
â”‚   â”œâ”€â”€ POST   /start
â”‚   â”œâ”€â”€ POST   /save-gaze-data
â”‚   â”œâ”€â”€ POST   /submit
â”‚   â””â”€â”€ GET    /:sessionId
â”œâ”€â”€ metrics/
â”‚   â”œâ”€â”€ POST   /calculate
â”‚   â””â”€â”€ GET    /:sessionId
â”œâ”€â”€ analysis/
â”‚   â”œâ”€â”€ POST   /ai-analyze
â”‚   â””â”€â”€ GET    /:sessionId/report
â”œâ”€â”€ admin/
â”‚   â”œâ”€â”€ GET    /sessions
â”‚   â”œâ”€â”€ GET    /session/:id/gaze-replay
â”‚   â”œâ”€â”€ POST   /session/:id/adjust-calibration
â”‚   â””â”€â”€ GET    /comparison
â””â”€â”€ templates/
    â”œâ”€â”€ GET    /
    â”œâ”€â”€ POST   /
    â”œâ”€â”€ PUT    /:id
    â””â”€â”€ DELETE /:id
```

### 5.2 ìƒì„¸ API ëª…ì„¸

#### 5.2.1 ìº˜ë¦¬ë¸Œë ˆì´ì…˜ API

**POST /api/v1/vision/calibration/check-environment**
```typescript
// í™˜ê²½ ì²´í¬ (ì¹´ë©”ë¼, ì¡°ëª…, ê±°ë¦¬)
Request: {
  userId: string;
  videoDeviceId: string;
}

Response: {
  success: boolean;
  checks: {
    cameraAccess: boolean;
    lightingLevel: number;        // 0-100
    faceDetected: boolean;
    eyesDetected: boolean;
    distanceEstimate: number;     // cm
    recommendations: string[];
  };
}
```

**POST /api/v1/vision/calibration/start**
```typescript
// ìº˜ë¦¬ë¸Œë ˆì´ì…˜ ì„¸ì…˜ ì‹œì‘
Request: {
  userId: string;
  deviceInfo: {
    browser: string;
    screenWidth: number;
    screenHeight: number;
    cameraResolution: string;
  };
}

Response: {
  success: boolean;
  calibrationId: string;
  points: Array<{ id: number; x: number; y: number }>;
}
```

**POST /api/v1/vision/calibration/record-point**
```typescript
// ìº˜ë¦¬ë¸Œë ˆì´ì…˜ í¬ì¸íŠ¸ ê¸°ë¡
Request: {
  calibrationId: string;
  pointId: number;              // 1-9
  gazeData: Array<{
    timestamp: number;
    x: number;
    y: number;
    confidence: number;
  }>;
}

Response: {
  success: boolean;
  pointAccuracy: number;
  averageGaze: { x: number; y: number };
  error: number;                // í”½ì…€ ë‹¨ìœ„
}
```

**POST /api/v1/vision/calibration/validate**
```typescript
// ìº˜ë¦¬ë¸Œë ˆì´ì…˜ ê²€ì¦ ë° ì™„ë£Œ
Request: {
  calibrationId: string;
}

Response: {
  success: boolean;
  overallAccuracy: number;      // 0-100
  averageError: number;         // í”½ì…€
  transformMatrix: number[][];
  isValid: boolean;
  recommendations?: string[];   // ì •í™•ë„ ë‚®ì„ ë•Œ ì¬ìº˜ë¦¬ ê¶Œì¥
}
```

#### 5.2.2 ì„¸ì…˜ API

**POST /api/v1/vision/session/start**
```typescript
// Vision í…ŒìŠ¤íŠ¸ ì„¸ì…˜ ì‹œì‘
Request: {
  userId: string;
  templateId: string;
  calibrationId: string;
}

Response: {
  success: boolean;
  sessionId: string;
  visionSessionId: string;
  template: {
    passages: Array<{
      id: string;
      text: string;
      fontSize: number;
      showWithQuestions: boolean;
    }>;
    questions: Question[];
  };
}
```

**POST /api/v1/vision/session/save-gaze-data**
```typescript
// ì‹¤ì‹œê°„ ì‹œì„  ë°ì´í„° ì €ì¥ (ì²­í¬ ë‹¨ìœ„)
Request: {
  visionSessionId: string;
  passageId: string;
  gazePoints: Array<{
    timestamp: number;
    x: number;
    y: number;
    confidence: number;
    type: 'fixation' | 'saccade' | 'blink';
    duration?: number;
  }>;
}

Response: {
  success: boolean;
  saved: number;                // ì €ì¥ëœ í¬ì¸íŠ¸ ê°œìˆ˜
}
```

**POST /api/v1/vision/session/submit**
```typescript
// í…ŒìŠ¤íŠ¸ ì œì¶œ (ë‹µì•ˆ + ìµœì¢… ì‹œì„  ë°ì´í„°)
Request: {
  visionSessionId: string;
  answers: Array<{
    questionId: string;
    answer: string;
    timeTaken: number;
  }>;
  finalGazeData?: GazePoint[];  // ë§ˆì§€ë§‰ ì²­í¬
}

Response: {
  success: boolean;
  resultId: string;
  processingStatus: 'queued' | 'processing' | 'completed';
}
```

#### 5.2.3 ë©”íŠ¸ë¦­ API

**POST /api/v1/vision/metrics/calculate**
```typescript
// 15ê°œ ë©”íŠ¸ë¦­ ê³„ì‚° (ë°±ê·¸ë¼ìš´ë“œ ì‘ì—…)
Request: {
  visionSessionId: string;
  textBounds: {               // í…ìŠ¤íŠ¸ ì˜ì—­ ì •ë³´
    passages: Array<{
      id: string;
      bounds: { x: number; y: number; width: number; height: number };
      lines: Array<{ y: number; height: number }>;
      words: Array<{ x: number; y: number; width: number; height: number; text: string }>;
    }>;
  };
}

Response: {
  success: boolean;
  metricsId: string;
  metrics: VisionMetrics;     // 15ê°œ ë©”íŠ¸ë¦­ ì „ì²´
}
```

#### 5.2.4 ë¶„ì„ API

**POST /api/v1/vision/analysis/ai-analyze**
```typescript
// AI ì½ê¸° ì „ëµ ë¶„ì„
Request: {
  visionSessionId: string;
}

Response: {
  success: boolean;
  analysis: {
    strategyType: 'detailed' | 'scanning' | 'skimming' | 'mixed';
    effectiveness: {
      timeEfficiency: number;
      comprehensionQuality: number;
      strategyMatch: number;
    };
    recommendations: Array<{
      strategy: string;
      reason: string;
      expectedImprovement: number;
    }>;
    strengths: string[];
    weaknesses: string[];
  };
}
```

**GET /api/v1/vision/analysis/:sessionId/report**
```typescript
// ì¢…í•© ë¦¬í¬íŠ¸ ì¡°íšŒ
Response: {
  success: boolean;
  report: {
    student: StudentInfo;
    test: TestInfo;
    overall: {
      eyeTrackingScore: number;
      comprehensionScore: number;
      gradeLevel: number;
    };
    metrics: VisionMetrics;
    analysis: AIAnalysis;
    visualizations: {
      heatmapUrl: string;
      gazePathData: GazePoint[];
      attentionZones: AttentionZone[];
    };
  };
}
```

#### 5.2.5 ê´€ë¦¬ì API

**GET /api/v1/vision/admin/sessions**
```typescript
// Vision ì„¸ì…˜ ëª©ë¡ ì¡°íšŒ (í•„í„°ë§)
Query: {
  grade?: number;
  startDate?: string;
  endDate?: string;
  studentId?: string;
}

Response: {
  success: boolean;
  sessions: Array<{
    id: string;
    studentName: string;
    grade: number;
    templateCode: string;
    completedAt: string;
    eyeTrackingScore: number;
    comprehensionScore: number;
  }>;
  total: number;
}
```

**GET /api/v1/vision/admin/session/:id/gaze-replay**
```typescript
// ì‹œì„  ê²½ë¡œ ì¬ìƒìš© ë°ì´í„°
Response: {
  success: boolean;
  replayData: {
    passage: {
      text: string;
      bounds: TextBounds;
    };
    gazePoints: GazePoint[];
    events: Array<{             // ì£¼ìš” ì´ë²¤íŠ¸
      timestamp: number;
      type: 'regression' | 'long_fixation' | 'line_skip' | 'off_page';
      severity: 'low' | 'medium' | 'high';
      location: { x: number; y: number };
    }>;
    duration: number;
    fps: number;
  };
}
```

**POST /api/v1/vision/admin/session/:id/adjust-calibration**
```typescript
// ìˆ˜ë™ ë³´ì • ì ìš©
Request: {
  adjustments: {
    horizontalOffset: number;
    verticalOffset: number;
    horizontalScale: number;
    verticalScale: number;
    rotation: number;
  };
  adminId: string;
}

Response: {
  success: boolean;
  adjustedMetrics: VisionMetrics;
  improvementScore: number;
}
```

#### 5.2.6 í…œí”Œë¦¿ ê´€ë¦¬ API

**GET /api/v1/vision/templates**
```typescript
// Vision í…œí”Œë¦¿ ëª©ë¡
Query: {
  grade?: number;
}

Response: {
  success: boolean;
  templates: Array<{
    id: string;
    code: string;
    title: string;
    grade: number;
    visionConfig: VisionConfig;
  }>;
}
```

**POST /api/v1/vision/templates**
```typescript
// Vision í…œí”Œë¦¿ ìƒì„±
Request: {
  code: string;
  title: string;
  grade: number;
  visionConfig: VisionConfig;
  passages: Array<{
    text: string;
    showWithQuestions: boolean;
  }>;
  questions: Array<QuestionData>;
}

Response: {
  success: boolean;
  templateId: string;
}
```

---

## 6. í”„ë¡ íŠ¸ì—”ë“œ êµ¬ì¡°

### 6.1 ë””ë ‰í† ë¦¬ êµ¬ì¡°

```
frontend/src/
â”œâ”€â”€ pages/
â”‚   â”œâ”€â”€ student/
â”‚   â”‚   â”œâ”€â”€ VisionTest/
â”‚   â”‚   â”‚   â”œâ”€â”€ EnvironmentCheck.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ Calibration.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ ReadingTest.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ Questions.tsx
â”‚   â”‚   â”‚   â””â”€â”€ VisionResult.tsx
â”‚   â”‚   â””â”€â”€ VisionTestContainer.tsx
â”‚   â””â”€â”€ admin/
â”‚       â”œâ”€â”€ VisionAnalytics.tsx
â”‚       â”œâ”€â”€ VisionReplay.tsx
â”‚       â”œâ”€â”€ VisionCalibrationAdjust.tsx
â”‚       â”œâ”€â”€ VisionComparison.tsx
â”‚       â””â”€â”€ VisionTemplateManagement.tsx
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ vision/
â”‚   â”‚   â”œâ”€â”€ EyeTracker/
â”‚   â”‚   â”‚   â”œâ”€â”€ FaceMeshLoader.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ GazeCalculator.ts
â”‚   â”‚   â”‚   â””â”€â”€ GazeVisualizer.tsx
â”‚   â”‚   â”œâ”€â”€ Calibration/
â”‚   â”‚   â”‚   â”œâ”€â”€ CalibrationGrid.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ CalibrationPoint.tsx
â”‚   â”‚   â”‚   â””â”€â”€ AccuracyIndicator.tsx
â”‚   â”‚   â”œâ”€â”€ Replay/
â”‚   â”‚   â”‚   â”œâ”€â”€ GazeReplayPlayer.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ GazePathCanvas.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ HeatmapLayer.tsx
â”‚   â”‚   â”‚   â””â”€â”€ TimelineControl.tsx
â”‚   â”‚   â”œâ”€â”€ Visualization/
â”‚   â”‚   â”‚   â”œâ”€â”€ AttentionHeatmap.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ GazePath3D.tsx
â”‚   â”‚   â”‚   â””â”€â”€ MetricsChart.tsx
â”‚   â”‚   â””â”€â”€ Analysis/
â”‚   â”‚       â”œâ”€â”€ StrategyAnalysis.tsx
â”‚   â”‚       â”œâ”€â”€ ComparisonView.tsx
â”‚   â”‚       â””â”€â”€ AICommentary.tsx
â”‚   â””â”€â”€ shared/
â”‚       â””â”€â”€ (ê¸°ì¡´ ê³µí†µ ì»´í¬ë„ŒíŠ¸)
â”œâ”€â”€ hooks/
â”‚   â”œâ”€â”€ useEyeTracking.ts
â”‚   â”œâ”€â”€ useCalibration.ts
â”‚   â”œâ”€â”€ useGazeRecorder.ts
â”‚   â””â”€â”€ useVisionMetrics.ts
â”œâ”€â”€ services/
â”‚   â”œâ”€â”€ visionApi.ts
â”‚   â”œâ”€â”€ gazeProcessor.ts
â”‚   â””â”€â”€ metricsCalculator.ts
â”œâ”€â”€ types/
â”‚   â””â”€â”€ vision.ts
â””â”€â”€ utils/
    â”œâ”€â”€ gazeUtils.ts
    â””â”€â”€ visualizationUtils.ts
```

### 6.2 í•µì‹¬ TypeScript íƒ€ì… ì •ì˜

```typescript
// types/vision.ts

// ì‹œì„  ë°ì´í„° í¬ì¸íŠ¸
export interface GazePoint {
  timestamp: number;
  x: number;
  y: number;
  confidence: number;
  type: 'fixation' | 'saccade' | 'blink';
  duration?: number;
}

// ìº˜ë¦¬ë¸Œë ˆì´ì…˜ í¬ì¸íŠ¸
export interface CalibrationPoint {
  id: number;
  x: number;
  y: number;
  gazeX?: number;
  gazeY?: number;
  error?: number;
  status: 'pending' | 'recording' | 'complete';
}

// Vision í…œí”Œë¦¿ ì„¤ì •
export interface VisionConfig {
  enableEyeTracking: boolean;
  targetGrade: number;
  calibrationPoints: number;
  passages: VisionPassage[];
  expectedMetrics: {
    saccade: [number, number];
    fixation: [number, number];
    regression: number;
    wpm: [number, number];
  };
}

// ì½ê¸° ì§€ë¬¸
export interface VisionPassage {
  id: string;
  text: string;
  fontSize: number;
  lineHeight: number;
  difficulty: number;
  expectedWPM: number;
  showPassageWithQuestions: boolean;  // ì§€ë¬¸-ë¬¸ì œ í† ê¸€
}

// í…ìŠ¤íŠ¸ ì˜ì—­ ì •ë³´
export interface TextBounds {
  x: number;
  y: number;
  width: number;
  height: number;
  lines: Array<{
    y: number;
    height: number;
  }>;
  words: Array<{
    x: number;
    y: number;
    width: number;
    height: number;
    text: string;
  }>;
}

// 15ê°œ ë©”íŠ¸ë¦­
export interface VisionMetrics {
  // A. ì‹œì„  ì´ë™ íŒ¨í„´
  averageSaccade: number;
  saccadeVariability: number;
  averageVelocity: number;
  optimalLandingRate: number;
  returnSweepAccuracy: number;
  blinkRate: number;
  scanPathEfficiency: number;

  // B. ì‘ì‹œ í–‰ë™
  averageFixation: number;
  fixationsPerWord: number;
  fixationsPerLine: number;
  regressionRate: number;
  vocabularyGapScore: number;

  // C. ì½ê¸° ì†ë„ ë° ë¦¬ë“¬
  wordsPerMinute: number;
  comprehensionAdjustedWPM: number;
  rhythmRegularity: number;
  staminaScore: number;

  // D. ì´í•´ ë° ì¸ì§€ ì²˜ë¦¬
  gazeComprehensionCorrelation: number;
  cognitiveLoadIndex: number;

  // ì¢…í•©
  overallEyeTrackingScore: number;
}

// AI ë¶„ì„ ê²°ê³¼
export interface AIAnalysis {
  strategyType: 'detailed' | 'scanning' | 'skimming' | 'mixed';
  effectiveness: {
    timeEfficiency: number;
    comprehensionQuality: number;
    strategyMatch: number;
  };
  recommendations: Array<{
    strategy: string;
    reason: string;
    expectedImprovement: number;
  }>;
  strengths: string[];
  weaknesses: string[];
}

// ì¬ìƒìš© ë°ì´í„°
export interface GazeReplayData {
  passage: {
    text: string;
    bounds: TextBounds;
  };
  gazePoints: GazePoint[];
  events: Array<{
    timestamp: number;
    type: 'regression' | 'long_fixation' | 'line_skip' | 'off_page';
    severity: 'low' | 'medium' | 'high';
    location: { x: number; y: number };
  }>;
  duration: number;
  fps: number;
}
```

---

## 7. í•µì‹¬ ê¸°ëŠ¥ ëª…ì„¸

### 7.1 í™˜ê²½ ì²´í¬ (Environment Check)

**ëª©ì **: ì‹œì„  ì¶”ì ì— ì í•©í•œ í™˜ê²½ì¸ì§€ ê²€ì¦

**ì²´í¬ í•­ëª©**:
1. ì¹´ë©”ë¼ ì ‘ê·¼ ê¶Œí•œ
2. ì–¼êµ´ ê°ì§€ ì„±ê³µ ì—¬ë¶€
3. ëˆˆë™ì ê°ì§€ ì„±ê³µ ì—¬ë¶€
4. ì¡°ëª… ìˆ˜ì¤€ (ë„ˆë¬´ ì–´ë‘¡ê±°ë‚˜ ë°ì§€ ì•Šì€ì§€)
5. í™”ë©´-ëˆˆ ê±°ë¦¬ ì¶”ì • (30-50cm ê¶Œì¥)

**UI ìš”ì†Œ**:
- ì‹¤ì‹œê°„ ë¹„ë””ì˜¤ í”¼ë“œë°±
- ì²´í¬ë¦¬ìŠ¤íŠ¸ (âœ…/âŒ)
- ê²½ê³  ë©”ì‹œì§€ ë° ê¶Œì¥ì‚¬í•­
- "í…ŒìŠ¤íŠ¸ ì‹œì‘" ë²„íŠ¼ (ëª¨ë“  ì²´í¬ í†µê³¼ ì‹œ í™œì„±í™”)

**ê¸°ìˆ  êµ¬í˜„**:
```typescript
// MediaPipe Face Meshë¡œ ì–¼êµ´ ëœë“œë§ˆí¬ ê°ì§€
const faceMesh = new FaceMesh({
  refineLandmarks: true,
  minDetectionConfidence: 0.7,
  minTrackingConfidence: 0.7
});

// í™˜ê²½ ì²´í¬ ë¡œì§
async function checkEnvironment() {
  const stream = await navigator.mediaDevices.getUserMedia({ video: true });
  const video = document.createElement('video');
  video.srcObject = stream;

  faceMesh.onResults((results) => {
    if (results.multiFaceLandmarks && results.multiFaceLandmarks.length > 0) {
      const landmarks = results.multiFaceLandmarks[0];

      // ëˆˆë™ì ëœë“œë§ˆí¬ í™•ì¸ (468-478: ì¢Œì•ˆ, 473-478: ìš°ì•ˆ)
      const leftEye = landmarks.slice(468, 478);
      const rightEye = landmarks.slice(473, 478);

      const checks = {
        faceDetected: true,
        eyesDetected: leftEye.length > 0 && rightEye.length > 0,
        distance: estimateDistance(landmarks),
        lighting: estimateLighting(video)
      };

      return checks;
    }
  });
}
```

---

### 7.2 ìº˜ë¦¬ë¸Œë ˆì´ì…˜ (Calibration)

**ëª©ì **: ê°œì¸ë³„ ì‹œì„  ì¶”ì  ì •í™•ë„ í–¥ìƒì„ ìœ„í•œ ë³´ì •

**í”„ë¡œì„¸ìŠ¤**:
1. 9í¬ì¸íŠ¸ ê·¸ë¦¬ë“œ í‘œì‹œ (3x3)
2. ê° í¬ì¸íŠ¸ì— ìˆœì°¨ì ìœ¼ë¡œ ì‹œì„  ê³ ì • (2ì´ˆ)
3. ì‹œì„  ë°ì´í„° ìˆ˜ì§‘ ë° ì˜¤ì°¨ ê³„ì‚°
4. ì „ì²´ ì •í™•ë„ í‰ê°€ (ëª©í‘œ: >70%)
5. ì •í™•ë„ ë¯¸ë‹¬ ì‹œ ì¬ìº˜ë¦¬ë¸Œë ˆì´ì…˜ ê¶Œì¥

**UI ìš”ì†Œ**:
- 3x3 ê·¸ë¦¬ë“œ
- í˜„ì¬ í™œì„± í¬ì¸íŠ¸ ê°•ì¡° (í„ìŠ¤ ì• ë‹ˆë©”ì´ì…˜)
- ì§„í–‰ë¥  í‘œì‹œ (1/9, 2/9, ...)
- í¬ì¸íŠ¸ë³„ ì •í™•ë„ í”¼ë“œë°±
- ì „ì²´ ì •í™•ë„ ê²Œì´ì§€

**ì •í™•ë„ ê³„ì‚°**:
```typescript
function calculateCalibrationAccuracy(
  targetPoint: { x: number; y: number },
  gazePoints: Array<{ x: number; y: number }>
): number {
  // í‰ê·  ì‹œì„  ìœ„ì¹˜
  const avgGaze = {
    x: gazePoints.reduce((sum, p) => sum + p.x, 0) / gazePoints.length,
    y: gazePoints.reduce((sum, p) => sum + p.y, 0) / gazePoints.length
  };

  // ìœ í´ë¦¬ë“œ ê±°ë¦¬ (í”½ì…€)
  const error = Math.sqrt(
    Math.pow(targetPoint.x - avgGaze.x, 2) +
    Math.pow(targetPoint.y - avgGaze.y, 2)
  );

  // ì •í™•ë„ ì ìˆ˜ (100 - ì˜¤ì°¨ ë¹„ìœ¨)
  // ì˜¤ì°¨ 0px = 100ì , ì˜¤ì°¨ 200px = 0ì 
  const accuracy = Math.max(0, 100 - (error / 200) * 100);

  return accuracy;
}
```

**ë³€í™˜ í–‰ë ¬ ê³„ì‚°**:
```typescript
// ìµœì†ŒììŠ¹ë²•ìœ¼ë¡œ ì¢Œí‘œ ë³€í™˜ í–‰ë ¬ ê³„ì‚°
function calculateTransformMatrix(
  calibrationPoints: CalibrationPoint[]
): number[][] {
  // Affine transformation matrix
  // [x'] = [a b c] [x]
  // [y']   [d e f] [y]
  //                [1]

  // ìµœì†ŒììŠ¹ë²• (Least Squares) ì ìš©
  // ...êµ¬í˜„ ìƒëµ (ìˆ˜í•™ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì‚¬ìš© ê¶Œì¥)

  return transformMatrix;
}
```

---

### 7.3 ì‹¤ì‹œê°„ ì‹œì„  ì¶”ì  (Real-time Gaze Tracking)

**ëª©ì **: ì½ê¸° ì¤‘ ì‹œì„  ë°ì´í„° ì‹¤ì‹œê°„ ìˆ˜ì§‘

**ë°ì´í„° ìˆ˜ì§‘**:
- ìƒ˜í”Œë§ ë ˆì´íŠ¸: 30-60 FPS
- ë°ì´í„° í¬ì¸íŠ¸: timestamp, x, y, confidence
- ë¶„ë¥˜: fixation(ì‘ì‹œ), saccade(ë„ì•½), blink(ê¹œë¹¡ì„)

**ì²­í¬ ë‹¨ìœ„ ì €ì¥**:
```typescript
// 5ì´ˆë§ˆë‹¤ ë˜ëŠ” 1000ê°œ í¬ì¸íŠ¸ë§ˆë‹¤ ì„œë²„ì— ì „ì†¡
const CHUNK_SIZE = 1000;
const CHUNK_INTERVAL = 5000; // 5ì´ˆ

let gazeBuffer: GazePoint[] = [];

function recordGazePoint(point: GazePoint) {
  gazeBuffer.push(point);

  if (gazeBuffer.length >= CHUNK_SIZE) {
    sendGazeChunk();
  }
}

async function sendGazeChunk() {
  if (gazeBuffer.length === 0) return;

  await fetch('/api/v1/vision/session/save-gaze-data', {
    method: 'POST',
    body: JSON.stringify({
      visionSessionId: currentSessionId,
      passageId: currentPassageId,
      gazePoints: gazeBuffer
    })
  });

  gazeBuffer = [];
}
```

**ì‹œì„  ë¶„ë¥˜ ì•Œê³ ë¦¬ì¦˜**:
```typescript
function classifyGazeType(
  currentPoint: { x: number; y: number; timestamp: number },
  previousPoint: { x: number; y: number; timestamp: number }
): 'fixation' | 'saccade' | 'blink' {
  const distance = calculateDistance(currentPoint, previousPoint);
  const timeDiff = currentPoint.timestamp - previousPoint.timestamp;
  const velocity = distance / timeDiff; // px/ms

  // ê¹œë¹¡ì„ ê°ì§€ (confidence ê¸‰ê²©íˆ í•˜ë½)
  if (currentPoint.confidence < 0.3) {
    return 'blink';
  }

  // ë„ì•½ ê°ì§€ (ë¹ ë¥¸ ì´ë™)
  if (velocity > 0.5) { // 0.5px/ms ì´ìƒ
    return 'saccade';
  }

  // ì‘ì‹œ (ëŠë¦° ì´ë™ ë˜ëŠ” ì •ì§€)
  return 'fixation';
}
```

---

### 7.4 ì§€ë¬¸-ë¬¸ì œ í† ê¸€ ê¸°ëŠ¥

**ëª©ì **: ì½ê¸° ì „ëµ í‰ê°€ (ì§€ë¬¸ ì°¸ì¡° vs ê¸°ì–µ ì˜ì¡´)

**êµ¬í˜„**:
```typescript
interface VisionPassage {
  showPassageWithQuestions: boolean; // ê´€ë¦¬ìê°€ ì„¤ì •
}

// í•™ìƒ í™”ë©´ ë Œë”ë§ ë¡œì§
function renderTestScreen(passage: VisionPassage, questions: Question[]) {
  if (passage.showPassageWithQuestions) {
    // ê¸°ë³¸ ëª¨ë“œ: ì§€ë¬¸ê³¼ ë¬¸ì œ ë™ì‹œ í‘œì‹œ
    return (
      <div className="grid grid-cols-2 gap-6">
        <PassagePanel text={passage.text} />
        <QuestionPanel questions={questions} />
      </div>
    );
  } else {
    // í† ê¸€ ëª¨ë“œ: ì§€ë¬¸ â†’ ë²„íŠ¼ â†’ ë¬¸ì œ (ì§€ë¬¸ ìˆ¨ê¹€)
    return currentScreen === 'passage' ? (
      <div>
        <PassagePanel text={passage.text} />
        <Button onClick={() => setCurrentScreen('questions')}>
          ë¬¸ì œ í’€ê¸°
        </Button>
      </div>
    ) : (
      <QuestionPanel questions={questions} />
    );
  }
}
```

**ê´€ë¦¬ì ì„¤ì • UI**:
```tsx
<ToggleSwitch
  label="ì½ê¸° ì§€ë¬¸ì„ ë¬¸ì œì™€ í•¨ê»˜ í‘œì‹œ"
  checked={showPassageWithQuestions}
  onChange={setShowPassageWithQuestions}
  description="OFF: ì§€ë¬¸ ì½ê¸° â†’ ë¬¸ì œ í’€ê¸° (ê¸°ì–µë ¥ í‰ê°€)"
/>
```

---

### 7.5 ì‹œì„  ê²½ë¡œ ì¬ìƒ (Gaze Replay)

**ê¸°ëŠ¥**:
- ì‹¤ì œ ì½ê¸° ê³¼ì • ì¬í˜„
- ì¬ìƒ ì†ë„ ì¡°ì ˆ (0.25x ~ 10x)
- ì‹œì„  ê²½ë¡œ ìƒ‰ìƒ ì½”ë”©
- ì‘ì‹œ ì› í¬ê¸° ë¹„ë¡€
- íƒ€ì„ë¼ì¸ ì‹œí¬
- ì´ë²¤íŠ¸ ë§ˆì»¤ (ì—­í–‰, ì´íƒˆ ë“±)

**Canvas ë Œë”ë§**:
```typescript
function renderGazeReplay(
  ctx: CanvasRenderingContext2D,
  currentTime: number,
  gazeData: GazePoint[],
  textBounds: TextBounds
) {
  // 1. í…ìŠ¤íŠ¸ ë ˆì´ì–´ (ë°°ê²½)
  ctx.fillStyle = '#ffffff';
  ctx.fillRect(0, 0, canvas.width, canvas.height);
  drawText(ctx, textBounds);

  // 2. í˜„ì¬ ì‹œê°„ê¹Œì§€ì˜ ì‹œì„  ê²½ë¡œ
  const visiblePoints = gazeData.filter(p => p.timestamp <= currentTime);

  // 3. ì‹œì„  ê²½ë¡œ ì„  ê·¸ë¦¬ê¸°
  for (let i = 1; i < visiblePoints.length; i++) {
    const from = visiblePoints[i - 1];
    const to = visiblePoints[i];

    // ì‹œì„  ìœ í˜•ì— ë”°ë¼ ìƒ‰ìƒ ê²°ì •
    const color = getPathColor(from, to, textBounds);

    ctx.strokeStyle = color;
    ctx.lineWidth = 2;
    ctx.beginPath();
    ctx.moveTo(from.x, from.y);
    ctx.lineTo(to.x, to.y);
    ctx.stroke();
  }

  // 4. ì‘ì‹œ ì› ê·¸ë¦¬ê¸°
  const fixations = visiblePoints.filter(p => p.type === 'fixation');
  fixations.forEach(fixation => {
    const radius = calculateCircleRadius(fixation.duration);

    ctx.fillStyle = 'rgba(59, 130, 246, 0.3)';
    ctx.strokeStyle = 'rgba(59, 130, 246, 0.8)';
    ctx.lineWidth = 2;

    ctx.beginPath();
    ctx.arc(fixation.x, fixation.y, radius, 0, Math.PI * 2);
    ctx.fill();
    ctx.stroke();
  });

  // 5. í˜„ì¬ ì‹œì„  ìœ„ì¹˜ (í„ìŠ¤ íš¨ê³¼)
  const currentPoint = visiblePoints[visiblePoints.length - 1];
  if (currentPoint) {
    ctx.fillStyle = 'rgba(59, 130, 246, 0.8)';
    ctx.beginPath();
    ctx.arc(currentPoint.x, currentPoint.y, 15, 0, Math.PI * 2);
    ctx.fill();
  }
}

function getPathColor(
  from: GazePoint,
  to: GazePoint,
  textBounds: TextBounds
): string {
  const type = classifyGaze(from, to, textBounds);

  const colors = {
    normal: '#10b981',           // ì´ˆë¡ìƒ‰
    regression: '#f59e0b',       // ì£¼í™©ìƒ‰
    longRegression: '#ef4444',   // ë¹¨ê°„ìƒ‰
    offPage: '#9ca3af',          // íšŒìƒ‰
    lineSkip: '#ec4899'          // ë¶„í™ìƒ‰
  };

  return colors[type] || colors.normal;
}
```

---

### 7.6 ìˆ˜ë™ ë³´ì • UI (Manual Calibration Adjustment)

**ê¸°ëŠ¥**:
- ì‹œì„  ë°ì´í„° ì¢Œìš°/ìƒí•˜ ì´ë™
- ê°€ë¡œ/ì„¸ë¡œ ìŠ¤ì¼€ì¼ ì¡°ì •
- íšŒì „ ì¡°ì •
- ì‹¤ì‹œê°„ ë¯¸ë¦¬ë³´ê¸°
- AI ìë™ ë³´ì • ì œì•ˆ

**UI êµ¬ì¡°**:
```tsx
<CalibrationAdjustmentPanel>
  {/* ë¶„í•  í™”ë©´ */}
  <div className="grid grid-cols-2 gap-6">
    {/* ì›ë³¸ */}
    <PreviewCanvas
      title="ë³´ì • ì „"
      gazeData={originalGazeData}
      textBounds={textBounds}
    />

    {/* ë³´ì • í›„ */}
    <PreviewCanvas
      title="ë³´ì • í›„"
      gazeData={adjustedGazeData}
      textBounds={textBounds}
    />
  </div>

  {/* ì¡°ì • ì»¨íŠ¸ë¡¤ */}
  <div className="space-y-4">
    <Slider
      label="ì¢Œìš° ì´ë™"
      value={horizontalOffset}
      onChange={setHorizontalOffset}
      min={-200}
      max={200}
      unit="px"
    />

    <Slider
      label="ìƒí•˜ ì´ë™"
      value={verticalOffset}
      onChange={setVerticalOffset}
      min={-200}
      max={200}
      unit="px"
    />

    <Slider
      label="ê°€ë¡œ ìŠ¤ì¼€ì¼"
      value={horizontalScale}
      onChange={setHorizontalScale}
      min={0.5}
      max={2.0}
      step={0.01}
    />

    <Button onClick={runAutoCalibration}>
      ğŸ¤– AI ìë™ ë³´ì •
    </Button>
  </div>

  {/* ì •í™•ë„ í†µê³„ */}
  <AccuracyStats
    onTextRate={calculateOnTextRate(adjustedGazeData)}
    lineAlignment={calculateLineAlignment(adjustedGazeData)}
  />
</CalibrationAdjustmentPanel>
```

**ìë™ ë³´ì • ì•Œê³ ë¦¬ì¦˜**:
```typescript
async function runAutoCalibration(
  gazeData: GazePoint[],
  textBounds: TextBounds
): Promise<Adjustments> {
  // ëª©ì  í•¨ìˆ˜: í…ìŠ¤íŠ¸ ì˜ì—­ ë‚´ ì‹œì„  ë¹„ìœ¨ ìµœëŒ€í™”
  function objective(adjustments: Adjustments): number {
    const adjusted = gazeData.map(p => applyAdjustments(p, adjustments));
    const onTextRate = calculateOnTextRate(adjusted, textBounds);
    return -onTextRate; // ìµœì†Œí™” ì•Œê³ ë¦¬ì¦˜ì´ë¯€ë¡œ ìŒìˆ˜í™”
  }

  // Nelder-Mead ìµœì í™”
  const result = await nelderMead(objective, {
    initialGuess: { horizontalOffset: 0, verticalOffset: 0, scale: 1, rotation: 0 },
    maxIterations: 1000
  });

  return result.bestSolution;
}
```

---

### 7.7 ì£¼ì˜ë ¥ íˆíŠ¸ë§µ (Attention Heatmap)

**ê¸°ëŠ¥**:
- ê°€ìš°ì‹œì•ˆ ë¸”ëŸ¬ íˆíŠ¸ë§µ
- ì£¼ì˜ë¥¼ ëˆ ë‹¨ì–´ Top 10
- ì˜ì—­ë³„ ì£¼ì˜ë ¥ ë¶„í¬

**êµ¬í˜„**:
```typescript
function generateHeatmap(
  gazeData: GazePoint[],
  canvasWidth: number,
  canvasHeight: number
): ImageData {
  // 1. ë¹ˆ íˆíŠ¸ë§µ ìƒì„±
  const heatmap = new Float32Array(canvasWidth * canvasHeight);

  // 2. ê° ì‘ì‹œ ì§€ì ì— ê°€ìš°ì‹œì•ˆ ë¶„í¬ ì ìš©
  gazeData
    .filter(p => p.type === 'fixation')
    .forEach(fixation => {
      const radius = 30; // ì˜í–¥ ë°˜ê²½
      const intensity = fixation.duration / 100; // ì‘ì‹œ ì‹œê°„ì— ë¹„ë¡€

      for (let dy = -radius; dy <= radius; dy++) {
        for (let dx = -radius; dx <= radius; dx++) {
          const distance = Math.sqrt(dx * dx + dy * dy);
          if (distance > radius) continue;

          const x = Math.round(fixation.x + dx);
          const y = Math.round(fixation.y + dy);
          if (x < 0 || x >= canvasWidth || y < 0 || y >= canvasHeight) continue;

          // ê°€ìš°ì‹œì•ˆ í•¨ìˆ˜
          const gaussian = Math.exp(-(distance * distance) / (2 * (radius / 3) * (radius / 3)));
          const index = y * canvasWidth + x;
          heatmap[index] += intensity * gaussian;
        }
      }
    });

  // 3. ì •ê·œí™” ë° ìƒ‰ìƒ ë§¤í•‘
  const maxValue = Math.max(...heatmap);
  const imageData = new ImageData(canvasWidth, canvasHeight);

  for (let i = 0; i < heatmap.length; i++) {
    const normalized = heatmap[i] / maxValue;
    const color = getHeatmapColor(normalized);

    imageData.data[i * 4 + 0] = color.r;
    imageData.data[i * 4 + 1] = color.g;
    imageData.data[i * 4 + 2] = color.b;
    imageData.data[i * 4 + 3] = Math.round(normalized * 255 * 0.6); // íˆ¬ëª…ë„
  }

  return imageData;
}

function getHeatmapColor(value: number): { r: number; g: number; b: number } {
  // íŒŒë€ìƒ‰ â†’ ë…¸ë€ìƒ‰ â†’ ë¹¨ê°„ìƒ‰
  if (value < 0.5) {
    // íŒŒë€ìƒ‰ â†’ ë…¸ë€ìƒ‰
    const t = value * 2;
    return {
      r: Math.round(59 + (251 - 59) * t),
      g: Math.round(130 + (191 - 130) * t),
      b: Math.round(246 - 246 * t)
    };
  } else {
    // ë…¸ë€ìƒ‰ â†’ ë¹¨ê°„ìƒ‰
    const t = (value - 0.5) * 2;
    return {
      r: Math.round(251 - (251 - 239) * t),
      g: Math.round(191 - (191 - 68) * t),
      b: Math.round(0 + (68 - 0) * t)
    };
  }
}
```

---

### 7.8 ë¹„êµ ë¶„ì„ (Comparison Analysis)

**ì‹œê³„ì—´ ë¹„êµ**:
```tsx
<TimeSeriesComparison studentId={selectedStudentId}>
  {/* íƒ€ì„ë¼ì¸ */}
  <Timeline>
    {sessions.map(session => (
      <SessionCard
        key={session.id}
        date={session.date}
        metrics={session.metrics}
        onClick={() => selectSession(session)}
        isSelected={selectedSessions.includes(session.id)}
      />
    ))}
  </Timeline>

  {/* ì„ íƒëœ ì„¸ì…˜ ë‚˜ë€íˆ ì¬ìƒ */}
  {selectedSessions.length === 2 && (
    <SideBySidePlayer
      leftSession={selectedSessions[0]}
      rightSession={selectedSessions[1]}
      synchronized={true}
    />
  )}

  {/* ë³€í™” ê·¸ë˜í”„ */}
  <ProgressChart
    metrics={['wpm', 'regressionRate', 'comprehensionScore']}
    sessions={allSessions}
  />
</TimeSeriesComparison>
```

**í•™ìƒ ê°„ ë¹„êµ**:
```tsx
<PeerComparison>
  <StudentSelector
    students={classStudents}
    maxSelect={4}
    selected={selectedStudents}
  />

  {/* 4ë¶„í•  í™”ë©´ */}
  <div className="grid grid-cols-2 gap-4">
    {selectedStudents.map(student => (
      <div key={student.id} className="space-y-2">
        <h3 className="font-semibold">{student.name}</h3>
        <GazeReplayPlayer session={student.latestSession} />
      </div>
    ))}
  </div>

  {/* ë¹„êµ ë ˆì´ë” ì°¨íŠ¸ */}
  <RadarChart
    students={selectedStudents}
    metrics={['speed', 'accuracy', 'efficiency', 'comprehension']}
  />
</PeerComparison>
```

---

### 7.9 AI ì½ê¸° ì „ëµ ë¶„ì„

**ë¶„ì„ í•­ëª©**:
1. ì „ëµ ë¶„ë¥˜: detailed / scanning / skimming / mixed
2. íš¨ê³¼ì„± í‰ê°€: ì‹œê°„ íš¨ìœ¨ì„±, ì´í•´ë„ í’ˆì§ˆ, ì í•©ë„
3. ê°œì¸ ë§ì¶¤ ì¶”ì²œ

**ë¶„ì„ ë¡œì§**:
```typescript
function analyzeReadingStrategy(
  gazeData: GazePoint[],
  textBounds: TextBounds,
  comprehensionScore: number
): AIAnalysis {
  // 1. ì½ê¸° íŒ¨í„´ íŠ¹ì§• ì¶”ì¶œ
  const features = {
    coverageRate: calculateCoverageRate(gazeData, textBounds),
    fixationsPerWord: calculateFixationsPerWord(gazeData, textBounds),
    regressionRate: calculateRegressionRate(gazeData),
    readingSpeed: calculateWPM(gazeData, textBounds),
    strategicSkips: detectStrategicSkips(gazeData, textBounds)
  };

  // 2. ì „ëµ ë¶„ë¥˜
  let strategyType: string;
  if (features.coverageRate > 0.9 && features.fixationsPerWord > 1.2) {
    strategyType = 'detailed'; // ì •ë…
  } else if (features.coverageRate < 0.7 && features.readingSpeed > 200) {
    strategyType = 'skimming'; // í›‘ì–´ì½ê¸°
  } else if (features.strategicSkips > 0.2) {
    strategyType = 'scanning'; // ìŠ¤ìºë‹
  } else {
    strategyType = 'mixed'; // í˜¼í•©
  }

  // 3. íš¨ê³¼ì„± í‰ê°€
  const effectiveness = {
    timeEfficiency: (features.readingSpeed / expectedWPM) * 100,
    comprehensionQuality: comprehensionScore,
    strategyMatch: evaluateStrategyMatch(strategyType, textDifficulty)
  };

  // 4. ì¶”ì²œ ìƒì„±
  const recommendations = generateRecommendations(strategyType, effectiveness);

  return {
    strategyType,
    effectiveness,
    recommendations,
    strengths: identifyStrengths(features),
    weaknesses: identifyWeaknesses(features)
  };
}
```

---

## 8. ì‚¬ìš©ì í”Œë¡œìš°

### 8.1 í•™ìƒ í”Œë¡œìš°

```
1. ë¡œê·¸ì¸
   â†“
2. í…ŒìŠ¤íŠ¸ ëª©ë¡ì—ì„œ "VISION_G2_001" ì„ íƒ
   â†“
3. í…ŒìŠ¤íŠ¸ ì•ˆë‚´ ë° ì£¼ì˜ì‚¬í•­ í™•ì¸
   â†“
4. [í™˜ê²½ ì²´í¬]
   - ì¹´ë©”ë¼ ê¶Œí•œ í—ˆìš©
   - ì–¼êµ´/ëˆˆ ê°ì§€ í™•ì¸
   - ì¡°ëª… ë° ê±°ë¦¬ ì²´í¬
   - âœ… ëª¨ë“  ì²´í¬ í†µê³¼
   â†“
5. [ìº˜ë¦¬ë¸Œë ˆì´ì…˜]
   - 9í¬ì¸íŠ¸ ìˆœì°¨ ì‘ì‹œ
   - ê° í¬ì¸íŠ¸ 2ì´ˆì”©
   - ì •í™•ë„ í‰ê°€ (>70%)
   - âŒ ë¯¸ë‹¬ ì‹œ ì¬ìº˜ë¦¬ / âœ… í†µê³¼ ì‹œ ë‹¤ìŒ ë‹¨ê³„
   â†“
6. [ì½ê¸° í…ŒìŠ¤íŠ¸]
   - ì§€ë¬¸ ì œì‹œ (ì‹¤ì‹œê°„ ì‹œì„  ì¶”ì  ì‹œì‘)
   - ìì—°ìŠ¤ëŸ½ê²Œ ì½ê¸°
   - 5ì´ˆë§ˆë‹¤ ì‹œì„  ë°ì´í„° ìë™ ì €ì¥
   â†“
7. [ë¬¸ì œ í’€ì´]
   Case A: ì§€ë¬¸ê³¼ í•¨ê»˜ í‘œì‹œ (ê¸°ë³¸)
     - ì§€ë¬¸ | ë¬¸ì œ ë‚˜ë€íˆ
   Case B: ì§€ë¬¸ ë¨¼ì €, ë¬¸ì œ ë”°ë¡œ (í† ê¸€)
     - ì§€ë¬¸ ì½ê¸° â†’ "ë¬¸ì œ í’€ê¸°" ë²„íŠ¼ â†’ ë¬¸ì œë§Œ í‘œì‹œ
   â†“
8. [ì œì¶œ]
   - ë‹µì•ˆ + ìµœì¢… ì‹œì„  ë°ì´í„° ì „ì†¡
   - ë°±ì—”ë“œ: ë©”íŠ¸ë¦­ ê³„ì‚° + AI ë¶„ì„ (ë¹„ë™ê¸°)
   â†“
9. [ê²°ê³¼ í™•ì¸]
   - ì¢…í•© ì ìˆ˜ (ì‹œì„  + ì´í•´ë„)
   - ì‹œì„  ê²½ë¡œ ì‹œê°í™”
   - AI ì§„ë‹¨ ë° í•™ìŠµ ì²˜ë°©
   - (ê´€ë¦¬ìë§Œ ì „ì²´ ì¬ìƒ ê¸°ëŠ¥ ì ‘ê·¼ ê°€ëŠ¥)
```

### 8.2 ê´€ë¦¬ì í”Œë¡œìš°

```
1. ê´€ë¦¬ì ë¡œê·¸ì¸
   â†“
2. "Vision Analytics" ë©”ë‰´ ì„ íƒ
   â†“
3. [ì„¸ì…˜ ëª©ë¡ ì¡°íšŒ]
   - í•„í„°: í•™ë…„, ë‚ ì§œ, í•™ìƒ
   - ì •ë ¬: ë‚ ì§œ, ì ìˆ˜
   â†“
4. íŠ¹ì • ì„¸ì…˜ ì„ íƒ
   â†“
5. [ì¢…í•© ë¦¬í¬íŠ¸]
   - í•™ìƒ ì •ë³´
   - 15ê°œ ë©”íŠ¸ë¦­
   - AI ë¶„ì„ ê²°ê³¼
   â†“
6. [ì‹œì„  ê²½ë¡œ ì¬ìƒ] ë²„íŠ¼ í´ë¦­
   â†“
7. [ì¬ìƒ í™”ë©´]
   - í…ìŠ¤íŠ¸ + ì‹œì„  ì˜¤ë²„ë ˆì´
   - ì¬ìƒ ì»¨íŠ¸ë¡¤ (ì†ë„, ì‹œí¬)
   - ë ˆì´ì–´ í† ê¸€ (ê²½ë¡œ, ì›, íˆíŠ¸ë§µ)
   - í•„í„° (ì •ìƒ/ì—­í–‰/ì´íƒˆ)
   â†“
8. (í•„ìš” ì‹œ) [ìˆ˜ë™ ë³´ì •]
   - "ë³´ì •í•˜ê¸°" ë²„íŠ¼
   - ì¢Œìš°/ìƒí•˜/ìŠ¤ì¼€ì¼/íšŒì „ ì¡°ì •
   - AI ìë™ ë³´ì • ì‹¤í–‰
   - ì ìš© ë° ì¬ê³„ì‚°
   â†“
9. (ì„ íƒ) [ë¹„êµ ë¶„ì„]
   - ì‹œê³„ì—´ ë¹„êµ: ê°™ì€ í•™ìƒì˜ ì§„ì „ë„
   - í•™ìƒ ê°„ ë¹„êµ: ìµœëŒ€ 4ëª… ë™ì‹œ
   â†“
10. [ë¦¬í¬íŠ¸ ë‹¤ìš´ë¡œë“œ/ê³µìœ ]
    - PDF ë‹¤ìš´ë¡œë“œ
    - í•™ë¶€ëª¨ ì´ë©”ì¼ ì „ì†¡
```

---

## 9. ê´€ë¦¬ì ê¸°ëŠ¥

### 9.1 Vision í…œí”Œë¦¿ ê´€ë¦¬

**ìƒì„±**:
```tsx
<VisionTemplateForm>
  <Input label="í…œí”Œë¦¿ ì½”ë“œ" value={code} placeholder="VISION_G2_001" />
  <Input label="ì œëª©" value={title} />
  <Select label="í•™ë…„" value={grade} options={[1,2,3,4,5,6]} />

  {/* ì½ê¸° ì§€ë¬¸ ì¶”ê°€ */}
  <PassageEditor>
    <Textarea
      label="ì§€ë¬¸ ë‚´ìš©"
      value={passage.text}
      rows={10}
    />
    <Slider
      label="ê¸€ì í¬ê¸°"
      value={passage.fontSize}
      min={16}
      max={32}
      unit="px"
    />
    <ToggleSwitch
      label="ë¬¸ì œ í’€ ë•Œ ì§€ë¬¸ í•¨ê»˜ í‘œì‹œ"
      checked={passage.showWithQuestions}
    />
  </PassageEditor>

  {/* ë¬¸ì œ ì¶”ê°€ (ê¸°ì¡´ ë¬¸í•­ ê´€ë¦¬ì™€ ë™ì¼) */}
  <QuestionList questions={questions} />

  {/* ì˜ˆìƒ ë©”íŠ¸ë¦­ ì„¤ì • (í•™ë…„ë³„ ë²¤ì¹˜ë§ˆí¬) */}
  <ExpectedMetrics>
    <RangeInput label="ì‹œì„  ë„ì•½í­ (px)" min={40} max={80} />
    <RangeInput label="ì‘ì‹œ ì‹œê°„ (ms)" min={250} max={400} />
    <Input label="ì—­í–‰ ë¹„ìœ¨ (%)" value={15} />
    <RangeInput label="ì½ê¸° ì†ë„ (WPM)" min={60} max={100} />
  </ExpectedMetrics>

  <Button type="submit">í…œí”Œë¦¿ ìƒì„±</Button>
</VisionTemplateForm>
```

### 9.2 Vision Analytics ëŒ€ì‹œë³´ë“œ

**í†µê³„ ì¹´ë“œ**:
```tsx
<DashboardLayout>
  <StatsGrid>
    <StatCard
      title="ì „ì²´ Vision í…ŒìŠ¤íŠ¸ ìˆ˜"
      value={totalSessions}
      icon={<EyeIcon />}
    />
    <StatCard
      title="í‰ê·  ì‹œì„  ì¶”ì  ì ìˆ˜"
      value={`${avgEyeTrackingScore.toFixed(1)}`}
      trend={+3.2}
    />
    <StatCard
      title="í‰ê·  ì´í•´ë„ ì ìˆ˜"
      value={`${avgComprehensionScore.toFixed(1)}`}
      trend={+5.1}
    />
    <StatCard
      title="í‰ê·  ì½ê¸° ì†ë„"
      value={`${avgWPM.toFixed(0)} WPM`}
      trend={+8}
    />
  </StatsGrid>

  {/* í•™ë…„ë³„ ë¹„êµ ì°¨íŠ¸ */}
  <BarChart
    title="í•™ë…„ë³„ í‰ê·  ë©”íŠ¸ë¦­"
    data={gradeComparisonData}
    xAxis="grade"
    yAxis={['eyeTrackingScore', 'comprehensionScore', 'wpm']}
  />

  {/* ìµœê·¼ ì„¸ì…˜ í…Œì´ë¸” */}
  <SessionTable sessions={recentSessions} />
</DashboardLayout>
```

---

## 10. ì„±ëŠ¥ ìš”êµ¬ì‚¬í•­

### 10.1 í”„ë¡ íŠ¸ì—”ë“œ ì„±ëŠ¥

| í•­ëª© | ëª©í‘œ | ì¸¡ì • ë°©ë²• |
|------|------|-----------|
| **ì´ˆê¸° ë¡œë”© ì‹œê°„** | < 3ì´ˆ | Lighthouse |
| **TensorFlow.js ëª¨ë¸ ë¡œë”©** | < 2ì´ˆ | Performance API |
| **MediaPipe ì´ˆê¸°í™”** | < 1ì´ˆ | Performance API |
| **ì‹œì„  ì¶”ì  FPS** | 30-60 FPS | ì‹¤ì‹œê°„ ì¸¡ì • |
| **ì¬ìƒ ë Œë”ë§ FPS** | 60 FPS | RequestAnimationFrame |
| **ìº˜ë¦¬ë¸Œë ˆì´ì…˜ ì‹œê°„** | < 60ì´ˆ | User Experience |
| **ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰** | < 500MB | Chrome DevTools |

### 10.2 ë°±ì—”ë“œ ì„±ëŠ¥

| í•­ëª© | ëª©í‘œ | ì¸¡ì • ë°©ë²• |
|------|------|-----------|
| **API ì‘ë‹µ ì‹œê°„** | < 200ms | APM |
| **ì‹œì„  ë°ì´í„° ì €ì¥** | < 100ms | Database Query |
| **ë©”íŠ¸ë¦­ ê³„ì‚°** | < 5ì´ˆ | Background Job |
| **AI ë¶„ì„** | < 10ì´ˆ | Background Job |
| **ì¬ìƒ ë°ì´í„° ì¡°íšŒ** | < 500ms | Database Query |
| **ë™ì‹œ ì ‘ì†** | 100ëª… | Load Testing |

### 10.3 ë°ì´í„°ë² ì´ìŠ¤ ì„±ëŠ¥

| í•­ëª© | ëª©í‘œ | ìµœì í™” ë°©ë²• |
|------|------|-------------|
| **ì‹œì„  ë°ì´í„° ì €ì¥** | < 50ms | Batch Insert, Index |
| **ë©”íŠ¸ë¦­ ì¡°íšŒ** | < 100ms | Index, Caching |
| **ì¬ìƒ ë°ì´í„° ì¡°íšŒ** | < 200ms | Index, Pagination |
| **í†µê³„ ì¿¼ë¦¬** | < 500ms | Materialized View |

---

## 11. ë³´ì•ˆ ë° ê°œì¸ì •ë³´

### 11.1 ë°ì´í„° ë³´í˜¸

**ì‹œì„  ë°ì´í„° ì²˜ë¦¬ ì›ì¹™**:
1. **ì–¼êµ´ ì˜ìƒ ë¯¸ì €ì¥**: ì‹¤ì‹œê°„ ì²˜ë¦¬ë§Œ, ì˜ìƒ íŒŒì¼ ì €ì¥ ê¸ˆì§€
2. **ì¢Œí‘œ ë°ì´í„°ë§Œ ì €ì¥**: (x, y, timestamp, confidence)ë§Œ ì €ì¥
3. **ì•”í˜¸í™” ì „ì†¡**: HTTPS í•„ìˆ˜
4. **ì ‘ê·¼ ì œí•œ**: ë³¸ì¸ê³¼ ê´€ë¦¬ìë§Œ ì¡°íšŒ ê°€ëŠ¥
5. **ë°ì´í„° ë³´ê´€ ê¸°ê°„**: 3ë…„ (ë²•ì  ìš”êµ¬ì‚¬í•­ ì¤€ìˆ˜)

**ë™ì˜ í”„ë¡œì„¸ìŠ¤**:
```tsx
<ConsentModal>
  <h2>ì‹œì„  ì¶”ì  í…ŒìŠ¤íŠ¸ ë™ì˜</h2>
  <p>
    ë³¸ í…ŒìŠ¤íŠ¸ëŠ” ì¹´ë©”ë¼ë¥¼ ì‚¬ìš©í•˜ì—¬ ì‹œì„ ì„ ì¶”ì í•©ë‹ˆë‹¤.
    ìˆ˜ì§‘ë˜ëŠ” ë°ì´í„°ëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤:
  </p>
  <ul>
    <li>âœ… ì‹œì„  ì¢Œí‘œ (x, y)</li>
    <li>âœ… ì‘ì‹œ ì‹œê°„</li>
    <li>âŒ ì–¼êµ´ ì˜ìƒ (ì €ì¥í•˜ì§€ ì•ŠìŒ)</li>
  </ul>
  <Checkbox
    label="ê°œì¸ì •ë³´ ìˆ˜ì§‘ ë° ì´ìš©ì— ë™ì˜í•©ë‹ˆë‹¤"
    checked={consentGiven}
    onChange={setConsentGiven}
    required
  />
  <Button disabled={!consentGiven}>ë™ì˜í•˜ê³  ì‹œì‘í•˜ê¸°</Button>
</ConsentModal>
```

### 11.2 í•™ë¶€ëª¨ ë™ì˜

**ë¯¸ì„±ë…„ì ë³´í˜¸**:
- ì´ˆë“±í•™ìƒ ëŒ€ìƒì´ë¯€ë¡œ í•™ë¶€ëª¨ ë™ì˜ í•„ìˆ˜
- íšŒì›ê°€ì… ì‹œ í•™ë¶€ëª¨ ì—°ë½ì²˜ ìˆ˜ì§‘
- Vision í…ŒìŠ¤íŠ¸ ìµœì´ˆ ì‹¤í–‰ ì‹œ í•™ë¶€ëª¨ì—ê²Œ SMS/ì´ë©”ì¼ ë™ì˜ ìš”ì²­

---

## 12. ê°œë°œ ë¡œë“œë§µ

### Phase 1: MVP (8ì£¼)

**Week 1-2: ê¸°ë°˜ êµ¬ì¶•**
- âœ… ë””ìì¸ ì‹œìŠ¤í…œ ì ìš©
- âœ… ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ êµ¬í˜„
- âœ… TensorFlow.js + MediaPipe í†µí•©
- âœ… ê¸°ë³¸ ì‹œì„  ì¶”ì  ë™ì‘ ê²€ì¦

**Week 3-4: ìº˜ë¦¬ë¸Œë ˆì´ì…˜**
- âœ… í™˜ê²½ ì²´í¬ UI
- âœ… 9í¬ì¸íŠ¸ ìº˜ë¦¬ë¸Œë ˆì´ì…˜
- âœ… ì •í™•ë„ í‰ê°€ ì•Œê³ ë¦¬ì¦˜
- âœ… ë°±ì—”ë“œ API êµ¬í˜„

**Week 5-6: í…ŒìŠ¤íŠ¸ ì§„í–‰**
- âœ… ì½ê¸° ì§€ë¬¸ í™”ë©´
- âœ… ì‹¤ì‹œê°„ ì‹œì„  ì¶”ì 
- âœ… ì²­í¬ ë‹¨ìœ„ ë°ì´í„° ì €ì¥
- âœ… ë¬¸ì œ í’€ì´ (í† ê¸€ ê¸°ëŠ¥ í¬í•¨)

**Week 7: ë©”íŠ¸ë¦­ ê³„ì‚°**
- âœ… 15ê°œ ë©”íŠ¸ë¦­ ê³„ì‚° ë¡œì§
- âœ… ë°±ì—”ë“œ ë¶„ì„ ì—”ì§„
- âœ… ê²°ê³¼ ë¦¬í¬íŠ¸ ìƒì„±

**Week 8: í…ŒìŠ¤íŠ¸ & ë²„ê·¸ ìˆ˜ì •**
- âœ… í†µí•© í…ŒìŠ¤íŠ¸
- âœ… ì„±ëŠ¥ ìµœì í™”
- âœ… ë²„ê·¸ ìˆ˜ì •

### Phase 2: ì‹œê°í™” (6ì£¼)

**Week 9-10: ì¬ìƒ ê¸°ëŠ¥**
- âœ… ì‹œì„  ê²½ë¡œ ì¬ìƒ UI
- âœ… Canvas ë Œë”ë§
- âœ… ì¬ìƒ ì»¨íŠ¸ë¡¤
- âœ… ìƒ‰ìƒ ì½”ë”© ë° ì‘ì‹œ ì›

**Week 11-12: ìˆ˜ë™ ë³´ì •**
- âœ… ë³´ì • UI
- âœ… ì‹¤ì‹œê°„ ë¯¸ë¦¬ë³´ê¸°
- âœ… AI ìë™ ë³´ì • ì•Œê³ ë¦¬ì¦˜

**Week 13-14: ê³ ê¸‰ ì‹œê°í™”**
- âœ… ì£¼ì˜ë ¥ íˆíŠ¸ë§µ
- âœ… ë¹„êµ ë¶„ì„ (ì‹œê³„ì—´, í•™ìƒ ê°„)
- âœ… AI ì½ê¸° ì „ëµ ë¶„ì„

### Phase 3: í™•ì¥ (4ì£¼)

**Week 15: ê´€ë¦¬ì ê¸°ëŠ¥**
- âœ… Vision Analytics ëŒ€ì‹œë³´ë“œ
- âœ… í…œí”Œë¦¿ ê´€ë¦¬ UI
- âœ… í†µê³„ ë° ë¦¬í¬íŠ¸

**Week 16: í•™ë¶€ëª¨ ê¸°ëŠ¥**
- âœ… ê°„ì†Œí™”ëœ ë¦¬í¬íŠ¸
- âœ… ì´ë©”ì¼ ì „ì†¡
- âœ… PDF ë‹¤ìš´ë¡œë“œ

**Week 17-18: ë‹¤ë¥¸ í•™ë…„ í™•ì¥**
- âœ… 3í•™ë…„, 4í•™ë…„ í…œí”Œë¦¿
- âœ… í•™ë…„ë³„ ë²¤ì¹˜ë§ˆí¬ ì¡°ì •
- âœ… ìµœì¢… í…ŒìŠ¤íŠ¸ ë° ë°°í¬

---

## 13. ì„±ê³µ ì§€í‘œ (KPI)

### 13.1 ê¸°ìˆ ì  ì„±ê³µ

| ì§€í‘œ | ëª©í‘œ | ì¸¡ì • ì£¼ê¸° |
|------|------|-----------|
| **ìº˜ë¦¬ë¸Œë ˆì´ì…˜ ì„±ê³µë¥ ** | > 85% | ì£¼ê°„ |
| **ì‹œì„  ì¶”ì  ì •í™•ë„** | > 70% | ì„¸ì…˜ë³„ |
| **ì‹œìŠ¤í…œ ê°€ë™ë¥ ** | > 99% | ì›”ê°„ |
| **í‰ê·  ì‘ë‹µ ì‹œê°„** | < 200ms | ì‹¤ì‹œê°„ |
| **ì˜¤ë¥˜ ë°œìƒë¥ ** | < 1% | ì¼ê°„ |

### 13.2 ì‚¬ìš©ì ê²½í—˜

| ì§€í‘œ | ëª©í‘œ | ì¸¡ì • ë°©ë²• |
|------|------|-----------|
| **í…ŒìŠ¤íŠ¸ ì™„ë£Œìœ¨** | > 90% | Analytics |
| **ì¬ìº˜ë¦¬ë¸Œë ˆì´ì…˜ ë¹„ìœ¨** | < 20% | Database |
| **ì‚¬ìš©ì ë§Œì¡±ë„** | > 4.0/5.0 | ì„¤ë¬¸ì¡°ì‚¬ |
| **ê´€ë¦¬ì ë¦¬í¬íŠ¸ ì¡°íšŒìœ¨** | > 70% | Analytics |

### 13.3 êµìœ¡ì  ì„±ê³¼

| ì§€í‘œ | ëª©í‘œ | ì¸¡ì • ë°©ë²• |
|------|------|-----------|
| **ì§„ë‹¨ ì •í™•ë„** | > 80% | ì „ë¬¸ê°€ í‰ê°€ |
| **ê°œì„ ë„ ì¶”ì  ê°€ëŠ¥ì„±** | 100% | ì‹œê³„ì—´ ë¹„êµ |
| **í•™ë¶€ëª¨ ì´í•´ë„** | > 75% | ì„¤ë¬¸ì¡°ì‚¬ |

---

## 14. ë¦¬ìŠ¤í¬ ë° ëŒ€ì‘ ë°©ì•ˆ

### 14.1 ê¸°ìˆ ì  ë¦¬ìŠ¤í¬

| ë¦¬ìŠ¤í¬ | ì˜í–¥ | í™•ë¥  | ëŒ€ì‘ ë°©ì•ˆ |
|--------|------|------|-----------|
| **ì •í™•ë„ ë¶€ì¡±** | ë†’ìŒ | ì¤‘ê°„ | ìº˜ë¦¬ë¸Œë ˆì´ì…˜ ê°•í™”, AI ë³´ì • |
| **ì„±ëŠ¥ ì €í•˜** | ì¤‘ê°„ | ë‚®ìŒ | ì½”ë“œ ìµœì í™”, ì²­í¬ í¬ê¸° ì¡°ì • |
| **ë¸Œë¼ìš°ì € í˜¸í™˜ì„±** | ì¤‘ê°„ | ë‚®ìŒ | í´ë¦¬í•„, ëŒ€ì²´ ë°©ì•ˆ ì œê³µ |
| **ëŒ€ìš©ëŸ‰ ë°ì´í„°** | ì¤‘ê°„ | ì¤‘ê°„ | ì••ì¶•, ì•„ì¹´ì´ë¹™ ì „ëµ |

### 14.2 ì‚¬ìš©ì ë¦¬ìŠ¤í¬

| ë¦¬ìŠ¤í¬ | ì˜í–¥ | í™•ë¥  | ëŒ€ì‘ ë°©ì•ˆ |
|--------|------|------|-----------|
| **í™˜ê²½ ë¶ˆì¼ì¹˜** | ë†’ìŒ | ë†’ìŒ | ìƒì„¸í•œ ì•ˆë‚´, í™˜ê²½ ì²´í¬ ê°•í™” |
| **ì§‘ì¤‘ ì‹œê°„ ë¶€ì¡±** | ì¤‘ê°„ | ì¤‘ê°„ | ì§§ì€ ì§€ë¬¸, ê²Œì„í™” |
| **ì¹´ë©”ë¼ ê±°ë¶€** | ë‚®ìŒ | ë‚®ìŒ | ì¼ë°˜ í…ŒìŠ¤íŠ¸ ëŒ€ì²´ ì œê³µ |

---

**ë¬¸ì„œ ë**
